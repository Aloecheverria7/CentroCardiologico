import{b as O,h as m,l as P,n as k,p as T,q as L,r as N,s as F,t as j,z as W}from"./chunk-XNJDAYY3.js";import{$a as i,D as g,Ea as p,Fa as u,Va as w,X as C,Xa as _,aa as c,ab as a,bb as y,fa as M,gb as v,hb as S,hc as E,p as x,qb as l,sb as I,ub as f,vb as h,wb as b}from"./chunk-6PSUBW4P.js";var z=(()=>{let t=class t{constructor(e,o){this.http=e,this.router=o,this.apiUrl=`${P.apiUrl}/user/login`}login(e,o){let r={username:e,password:o};return this.http.post(this.apiUrl,r).pipe(g(d=>(console.error("Error en el login:",d),x(()=>new Error(d.message||"Error de autenticaci\xF3n")))))}setToken(e){localStorage.setItem("authToken",e)}getToken(){return localStorage.getItem("authToken")}logout(){localStorage.removeItem("authToken"),this.router.navigate(["/login"])}isAuthenticated(){let e=this.getToken();if(!e)return!1;try{return JSON.parse(atob(e.split(".")[1])).exp>Date.now()/1e3}catch{return!1}}};t.\u0275fac=function(o){return new(o||t)(c(O),c(m))},t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();function U(n,t){if(n&1&&(i(0,"div",11),l(1),a()),n&2){let D=S();p(),I(" ",D.errorMessage," ")}}var X=(()=>{let t=class t{constructor(e,o){this.authService=e,this.router=o,this.username="",this.password="",this.errorMessage=""}ngOnInit(){}onLogin(){this.authService.login(this.username,this.password).pipe(g(e=>(this.errorMessage="Credenciales incorrectas",console.error("Error de login:",e),e))).subscribe(e=>{this.authService.setToken(e.token),console.log("Inicio Exitoso"),this.router.navigate(["/dashboard/calendar"]).then(()=>{console.log("Redirigiendo a Dashboard...")})})}};t.\u0275fac=function(o){return new(o||t)(u(z),u(m))},t.\u0275cmp=M({type:t,selectors:[["app-login"]],decls:17,vars:3,consts:[[1,"login-container"],[1,"logo-container"],["src","assets/logo.png","alt","Hospital Logo",1,"logo"],[1,"login-form",3,"submit"],[1,"form-group"],["for","username"],["type","text","id","username","name","username","placeholder","Ingrese su usuario","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","placeholder","Ingrese su contrase\xF1a","required","",3,"ngModelChange","ngModel"],["type","submit",1,"btn-submit"],["class","error-message",4,"ngIf"],[1,"error-message"]],template:function(o,r){o&1&&(i(0,"div",0)(1,"div",1),y(2,"img",2),a(),i(3,"h2"),l(4,"Iniciar sesi\xF3n"),a(),i(5,"form",3),v("submit",function(){return r.onLogin()}),i(6,"div",4)(7,"label",5),l(8,"Nombre de usuario"),a(),i(9,"input",6),b("ngModelChange",function(s){return h(r.username,s)||(r.username=s),s}),a()(),i(10,"div",4)(11,"label",7),l(12,"Contrase\xF1a"),a(),i(13,"input",8),b("ngModelChange",function(s){return h(r.password,s)||(r.password=s),s}),a()(),i(14,"button",9),l(15,"Iniciar sesi\xF3n"),a()(),w(16,U,2,1,"div",10),a()),o&2&&(p(9),f("ngModel",r.username),p(4),f("ngModel",r.password),p(3),_("ngIf",r.errorMessage))},dependencies:[E,j,k,T,L,W,F,N],styles:[".login-container[_ngcontent-%COMP%]{max-width:400px;margin:50px auto;padding:20px;background-color:#f9f9f9;box-shadow:0 4px 8px #0000001a;border-radius:10px;text-align:center;font-family:Arial,sans-serif}.logo-container[_ngcontent-%COMP%]{margin-bottom:20px}.logo[_ngcontent-%COMP%]{max-width:100px;height:auto}h2[_ngcontent-%COMP%]{margin-bottom:20px;font-size:24px;color:#333}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]{margin-bottom:15px;text-align:left}label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:5px;color:#555}input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:5px;font-size:16px;box-sizing:border-box}input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 4px #007bff33}.btn-submit[_ngcontent-%COMP%]{padding:10px;background-color:#007bff;color:#fff;border:none;border-radius:5px;font-size:16px;cursor:pointer;transition:background-color .3s ease}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#0056b3}.error-message[_ngcontent-%COMP%]{margin-top:15px;color:#d9534f;font-weight:700;font-size:14px}@media (max-width: 768px){.login-container[_ngcontent-%COMP%]{margin:20px}.logo[_ngcontent-%COMP%]{max-width:80px}}"]});let n=t;return n})();export{X as a};
